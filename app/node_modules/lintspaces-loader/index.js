var Validator = require('lintspaces');

// Identity loader
module.exports = function(source) {
	var validator = new Validator({
		// Tests for newlines at the end of all files.
		newline: true,

		// Tests for useless whitespaces (trailing whitespaces) at each lineending
		// of all files.
		trailingspaces: true,

		// Tests for correct indentation using tabs or spaces.
		indentation: 'tabs',

		// Lintspaces fails with incorrect indentation errors when files contain
		// Byte Order Marks (BOM). If you don't want to give false positives for
		// inconsistent tabs or spaces, set the allowsBOM option to true.
		allowsBOM: true,
	});

	validator.validate(this.resourcePath);
	var results = validator.getInvalidFiles()[this.resourcePath];
	if(results) {
		console.log(this.resourcePath + ":")
		for (var line in results) {
			var errors = results[line]
			for (var i = 0; i < errors.length; i++) {
				var err = errors[i]
				console.log("\t" + err.type + ": " + "(line " + err.line + ") " + err.message)
			}
		}
		console.log("")
	}
	return source;
};
