<div class="row">
	<div class="col-md-6">
		<form class="form-inline">
			<label for="os-selector">Choose your operating system:</label>
			<select class="form-control" onchange="refreshInstructions()" id="os-selector" name="os-selector">
			  <option disabled selected>-- select an option --</option>
			  <option value="mac">Mac OS X (10.8+)</option>
			  <option value="ubuntu">Ubuntu (12.04 & 14.04)</option>
			  <option value="centos">CentOS (6.3)</option>
			  <option value="redhat">RedHat (7.1)</option>
			  <option value="source">from source code</option>
			</select>
		</form>
	</div>
</div>

<br>
<div id="instructions"></div>

<script>
var installURL = "https://sourcegraph.com/.download/install.sh";
var curlInstall = "<code>curl -sSL " + installURL + " | bash</code>";
var wgetInstall = "<code>wget -O - " + installURL + " | bash</code>";

var macBinary =
	"<strong><a href=\"https://sourcegraph.com/.download/latest/darwin-amd64/src.gz\">src.gz</a></strong>";
var linuxBinary =
	"<strong><a href=\"https://sourcegraph.com/.download/latest/linux-amd64/src.gz\">src.gz</a></strong>";
var debFile =
	"<strong><a href=\"https://sourcegraph.com/.download/latest/linux-amd64/src.deb\">src.deb (64-bit)</a></strong>";
var rpmFile =
	"<strong><a href=\"https://sourcegraph.com/.download/latest/linux-amd64/src.rpm\">src.rpm (64-bit)</a></strong>";

var runSrcServe = function(linux) {
	var str = "<h2>Run a local Sourcegraph server</h2><p><pre>src serve</pre></p>";
	if (linux) {
		str += "<p>Or, if you installed using the <code>.deb</code> or <code>.rpm</code> and have upstart installed...</p><p><pre>sudo restart src</pre></p>";
	}
	return str;
}

var visitLocalhost =
	"<h2>Visit <a href=\"http://localhost:3080\">http://localhost:3080</a> to create an admin account</h2>" +
	"<p>And make sure everything is working</p>";

var installOptions = function() {
	return "<p><pre>" + arguments[0] + "</pre></p><p>Or, direct downloads: " + arguments[1] + "</p>";
}

var macInstructions = installOptions(curlInstall, macBinary) + runSrcServe(false) + visitLocalhost;

var ubuntuInstructions = installOptions(wgetInstall, debFile + " or " + linuxBinary) + runSrcServe(true) + visitLocalhost;

var centosInstructions = installOptions(curlInstall, rpmFile + " or " + linuxBinary) + runSrcServe(true) + visitLocalhost;

var redhatInstructions = installOptions(curlInstall, rpmFile + " or " + linuxBinary) + runSrcServe(true) + visitLocalhost;

var instructions = function(os) {
	if (os == "mac") {
		return macInstructions;
	}
	if (os == "ubuntu") {
		return ubuntuInstructions;
	}
	if (os == "centos") {
		return centosInstructions;
	}
	if (os == "redhat") {
		return redhatInstructions;
	}
	if (os == "source") {
		return "<p>Follow the <strong><a href=\"https://src.sourcegraph.com/sourcegraph@master/.tree/README.dev.md\">developer README</a></strong>.</p>";
	}
	return "";
}

var setInstructions = function(instructions) {
	document.getElementById("instructions").innerHTML = instructions;
}

var refreshInstructions = function() {
	var el = document.getElementById("os-selector");
	setInstructions(instructions(el.options[el.selectedIndex].value));
}

refreshInstructions() // initialization
</script>
